import{a as R}from"./chunk-UGR5QE26.js";import"./chunk-RGXSXGDA.js";import{a as N}from"./chunk-WF7QN2QH.js";import"./chunk-L2MR3JKQ.js";import{a as E}from"./chunk-VP5QEZ2X.js";import{a as S}from"./chunk-SZJ6MPGP.js";import"./chunk-RTA3XN6B.js";import{k as v,l as P,m as w}from"./chunk-XQSHTZQE.js";import{$a as u,Eb as k,Fb as s,Gb as y,Kb as O,Ra as c,Wa as b,cb as g,ha as _,ia as h,mb as d,ob as x,pb as M,tb as a,ub as r,wb as f,xb as C,yb as m}from"./chunk-RHHAP76N.js";function I(o,e){if(o&1&&(a(0,"span"),s(1," \u2605 "),r()),o&2){let t=e.$implicit;x("filled",t)}}function F(o,e){if(o&1){let t=f();a(0,"tr",10),C("click",function(){let i=_(t).$implicit,l=m(2);return h(l.openRecipe(i))}),a(1,"td"),s(2),r(),a(3,"td")(4,"div",11),g(5,I,2,2,"span",12),r()()()}if(o&2){let t=e.$implicit,n=m(2);c(2),y(t.title),c(3),d("ngForOf",n.getStars(t.rating))}}function T(o,e){if(o&1&&(a(0,"div",7)(1,"table")(2,"thead")(3,"tr")(4,"th"),s(5,"Title"),r(),a(6,"th",8),s(7,"Rating"),r()()(),a(8,"tbody"),g(9,F,6,2,"tr",9),r()()()),o&2){let t=m();c(9),d("ngForOf",t.filtered)}}function V(o,e){o&1&&(a(0,"div",13),s(1,"No recipes found."),r())}function $(o,e){if(o&1){let t=f();a(0,"app-terminal-dialog",14),C("closeDialogEvent",function(){_(t);let i=m();return h(i.closeDialog())}),r()}if(o&2){let t=m();d("title",(t.selected==null?null:t.selected.title)||"Recipe")("component","recipe")("componentData",t.selected)}}var D=class o{constructor(e){this.sheets=e}recipes=[];filtered=[];selected=null;query="";ngOnInit(){let e=S.cookbookCsvUrl;e&&this.sheets.fetchBooksFromSheet(e).then(t=>{this.recipes=Array.isArray(t)?t.map(n=>this.toRecipe(n)).filter(n=>!!n.title).sort((n,i)=>n.title.localeCompare(i.title)):[],this.applyFilter()}).catch(()=>{this.recipes=[],this.filtered=[]})}applyFilter(e){typeof e=="string"&&(this.query=e);let t=(this.query??"").trim().toLowerCase();if(!t){this.filtered=[...this.recipes];return}let n=Number(t);if(!Number.isNaN(n)&&n>=1&&n<=5&&/^\d$/.test(t)){let l=Math.round(n);this.filtered=this.recipes.filter(p=>Math.round(p.rating)===l);return}this.filtered=this.recipes.filter(l=>`${l.title} ${l.ingredients??""} ${l.instructions??""}`.toLowerCase().includes(t))}getStars(e){let t=Math.max(0,Math.min(5,Math.round(e)));return Array.from({length:5},(n,i)=>i<t)}openRecipe(e){this.selected=e}closeDialog(){this.selected=null}toRecipe(e){let t=e?.title??e?.Title??e?.Name??"",n=e?.ingredients??e?.Ingredients??"",i=e?.instructions??e?.Instructions??e?.Steps??"",l=e?.Rating??e?.rating??e?.score??e?.Score??0,p=Number.isNaN(Number(l))?0:Math.max(0,Math.min(5,Number(l)));return{id:e?.id??e?.ID??"",title:t,ingredients:n,instructions:i,rating:p}}static \u0275fac=function(t){return new(t||o)(b(E))};static \u0275cmp=u({type:o,selectors:[["app-cookbook"]],decls:10,vars:5,consts:[["emptyState",""],[1,"cookbook"],[1,"panel"],[1,"panel-header"],[3,"valueChange","placeholder","value"],["class","table-wrapper",4,"ngIf","ngIfElse"],[3,"title","component","componentData"],[1,"table-wrapper"],[1,"rating-col"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],[1,"stars"],[3,"filled",4,"ngFor","ngForOf"],[1,"empty"],[3,"closeDialogEvent","title","component","componentData"]],template:function(t,n){if(t&1){let i=f();a(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),s(4,"Cookbook"),r(),a(5,"app-search-input",4),C("valueChange",function(p){return _(i),h(n.applyFilter(p))}),r()(),g(6,T,10,1,"div",5)(7,V,2,0,"ng-template",null,0,O),r(),g(9,$,1,3,"app-terminal-dialog",6),r()}if(t&2){let i=k(8);c(5),d("placeholder","Search recipes by name or ingredients...")("value",n.query),c(),d("ngIf",n.filtered.length)("ngIfElse",i),c(3),M(n.selected?9:-1)}},dependencies:[w,v,P,N,R],styles:[".cookbook[_ngcontent-%COMP%]{height:80vh;display:flex;align-items:flex-start;justify-content:center;padding-top:8vh;color:#0f0;font-family:Courier New,monospace}.panel[_ngcontent-%COMP%]{width:80vw;max-width:1200px;height:100%;background:#000c;border:1px solid rgb(0,255,0);border-radius:10px;box-shadow:0 0 18px #00ff0040;padding:1.25rem}.panel-header[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;gap:.75rem;margin-bottom:1rem}.panel-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:2rem;text-align:center;letter-spacing:.04em}.table-wrapper[_ngcontent-%COMP%]{max-height:85%;border:1px solid rgb(0,255,0);border-radius:8px;background:#000000e6}table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;table-layout:fixed}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.9rem .8rem;border-bottom:1px solid rgba(0,0,0,.7);text-align:left;word-break:break-word}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{font-size:1.25rem;letter-spacing:.03em;border-bottom:1px solid rgb(0,255,0)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid rgba(0,0,0,.7)}table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{transition:background .2s ease,transform .2s ease}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#000000b3;box-shadow:0 0 12px #0f0c;cursor:pointer;font-weight:700}tbody[_ngcontent-%COMP%]{display:block;max-height:60vh;overflow-y:auto;overflow-x:hidden;width:100%;scrollbar-width:none;-ms-overflow-style:none}tbody[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}thead[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:table;width:100%;table-layout:fixed}.rating-col[_ngcontent-%COMP%]{width:140px}tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:nth-child(2){width:140px}.stars[_ngcontent-%COMP%]{display:inline-flex;gap:4px}.stars[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#000000b3;text-shadow:none;transition:color .15s ease}.stars[_ngcontent-%COMP%]   span.filled[_ngcontent-%COMP%]{color:#0f0;text-shadow:0 0 6px rgba(0,255,0,.4)}.empty[_ngcontent-%COMP%]{text-align:center;padding:2rem 0;opacity:.7}@media (max-width: 900px){.panel[_ngcontent-%COMP%]{width:92vw;padding:1rem}.table-wrapper[_ngcontent-%COMP%], tbody[_ngcontent-%COMP%]{max-height:none}table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.7rem}}"]})};export{D as CookbookComponent};
