import{a as B}from"./chunk-WF7QN2QH.js";import{a as S}from"./chunk-L2MR3JKQ.js";import{a as D}from"./chunk-VP5QEZ2X.js";import{a as O}from"./chunk-SZJ6MPGP.js";import{c as M}from"./chunk-RTA3XN6B.js";import{k as w,l as x,m as P}from"./chunk-XQSHTZQE.js";import{$a as v,Fb as c,Gb as m,Ma as y,Ra as r,Wa as h,cb as u,g as f,mb as d,tb as g,ub as s,vb as _,xb as C,yb as b}from"./chunk-RHHAP76N.js";function F(i,o){i&1&&(g(0,"div",7),c(1,"Loading blog posts..."),s())}function z(i,o){if(i&1&&(g(0,"div",8),c(1),s()),i&2){let t=b();r(),m(t.error)}}function E(i,o){i&1&&(g(0,"div",7),c(1," No posts available yet. "),s())}function H(i,o){i&1&&(g(0,"div",7),c(1," No posts match your search. "),s())}function L(i,o){if(i&1&&(g(0,"article",11)(1,"h2",12),c(2),s(),g(3,"div",13),c(4),s(),_(5,"div",14),s()),i&2){let t=o.$implicit;r(2),m(t.title),r(2),m(t.displayDate),r(),d("innerHTML",t.html,y)}}function $(i,o){if(i&1&&(g(0,"div",9),u(1,L,6,3,"article",10),s()),i&2){let t=b();r(),d("ngForOf",t.filtered)}}var I=class i{constructor(o,t){this.sheets=o;this.sanitizer=t}posts=[];filtered=[];loading=!1;error=null;query="";ngOnInit(){this.loadPosts()}loadPosts(){return f(this,null,function*(){let o=O.blogCsvUrl;if(!o){this.error="No blog source configured.";return}this.loading=!0,this.error=null;try{let t=yield this.sheets.fetchBooksFromSheet(o),e=yield Promise.all(t.map(n=>this.mapRow(n)));this.posts=e.filter(n=>!!n).sort((n,l)=>{let a=l.date.getTime()-n.date.getTime();return a!==0?a:this.compareIds(l.id,n.id)}),this.applyFilter()}catch{this.error="Failed to load blog posts.",this.posts=[],this.filtered=[]}finally{this.loading=!1}})}mapRow(o){return f(this,null,function*(){let t=new Map;Object.entries(o||{}).forEach(([k,T])=>{t.set(k.trim().toLowerCase(),String(T??"").trim())});let e=t.get("id")??"",n=t.get("title")??"",l=t.get("date")??"",a=t.get("content")??"",p=this.parseDate(l);if(!n||!a||!p)return null;let N=yield S.parse(a);return{id:e,title:n,date:p,displayDate:this.formatDate(p),content:a,html:this.sanitizer.bypassSecurityTrustHtml(N)}})}applyFilter(o){typeof o=="string"&&(this.query=o);let t=(this.query??"").trim().toLowerCase();if(!t){this.filtered=[...this.posts];return}this.filtered=this.posts.filter(e=>`${e.title} ${e.content}`.toLowerCase().includes(t))}formatDate(o){let t=String(o.getDate()).padStart(2,"0"),e=String(o.getMonth()+1).padStart(2,"0"),n=o.getFullYear();return`${t}.${e}.${n}`}parseDate(o){let t=o.split(".");if(t.length!==3)return null;let[e,n,l]=t.map(p=>Number(p));if(!e||!n||!l)return null;let a=new Date(l,n-1,e);return a.getDate()===e&&a.getMonth()===n-1&&a.getFullYear()===l?a:null}compareIds(o,t){let e=Number(o),n=Number(t);return!Number.isNaN(e)&&!Number.isNaN(n)?e-n:o.localeCompare(t)}static \u0275fac=function(t){return new(t||i)(h(D),h(M))};static \u0275cmp=v({type:i,selectors:[["app-blog"]],decls:9,vars:7,consts:[[1,"blog"],[1,"blog-search"],[3,"valueChange","placeholder","value"],[1,"blog-body"],["class","state",4,"ngIf"],["class","state error",4,"ngIf"],["class","blog-grid",4,"ngIf"],[1,"state"],[1,"state","error"],[1,"blog-grid"],["class","blog-card",4,"ngFor","ngForOf"],[1,"blog-card"],[1,"blog-title"],[1,"blog-date"],[1,"blog-content",3,"innerHTML"]],template:function(t,e){t&1&&(g(0,"div",0)(1,"div",1)(2,"app-search-input",2),C("valueChange",function(l){return e.applyFilter(l)}),s()(),g(3,"div",3),u(4,F,2,0,"div",4)(5,z,2,1,"div",5)(6,E,2,0,"div",4)(7,H,2,0,"div",4)(8,$,2,1,"div",6),s()()),t&2&&(r(2),d("placeholder","Search posts by title or content...")("value",e.query),r(2),d("ngIf",e.loading),r(),d("ngIf",!e.loading&&e.error),r(),d("ngIf",!e.loading&&!e.error&&e.posts.length===0),r(),d("ngIf",!e.loading&&!e.error&&e.posts.length&&e.filtered.length===0),r(),d("ngIf",!e.loading&&!e.error&&e.filtered.length))},dependencies:[P,w,x,B],styles:[".blog[_ngcontent-%COMP%]{position:absolute;top:8vh;left:5vw;right:5vw;bottom:8vh;display:flex;flex-direction:column;gap:1rem;padding:1rem;background:#00000080;border:0;border-radius:10px;overflow:hidden;font-family:Courier New,monospace;scrollbar-width:none;-ms-overflow-style:none}.blog[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.blog-search[_ngcontent-%COMP%]{display:flex;justify-content:center}.blog-body[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;overflow:auto;scrollbar-width:none;-ms-overflow-style:none}.blog-body[_ngcontent-%COMP%]::-webkit-scrollbar{display:none}.state[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:100%;height:100%;text-align:center;padding:0;color:#0f0;font-size:2rem;font-weight:700;text-shadow:0 0 10px rgb(0,0,0),0 0 28px rgba(0,0,0,.8);background-color:#00000080}.state.error[_ngcontent-%COMP%]{color:#fa3535}@media (max-width: 900px){.state[_ngcontent-%COMP%]{font-size:1.25rem}}.blog-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr}@media (min-width: 900px){.blog-grid[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}}.blog-card[_ngcontent-%COMP%]{margin:10px;padding:10px;border-radius:10px;background:#000c;border:1px solid rgb(0,255,0);box-shadow:0 0 12px #00ff001a;color:#f5f5f5;min-width:45%}.blog-title[_ngcontent-%COMP%]{margin:0 0 6px;color:#0f0;font-size:1.5rem}.blog-date[_ngcontent-%COMP%]{font-size:.85rem;color:#ffffffb3;margin-bottom:10px}[_nghost-%COMP%]     .blog-content{line-height:1.5;word-wrap:break-word}[_nghost-%COMP%]     .blog-content h1, [_nghost-%COMP%]     .blog-content h2, [_nghost-%COMP%]     .blog-content h3, [_nghost-%COMP%]     .blog-content h4, [_nghost-%COMP%]     .blog-content h5, [_nghost-%COMP%]     .blog-content h6{color:#0f0;margin:.5rem 0}[_nghost-%COMP%]     .blog-content p{margin:.5rem 0}[_nghost-%COMP%]     .blog-content a{color:#ff0000b3}[_nghost-%COMP%]     .blog-content code{background:#111;padding:2px 4px;border-radius:4px}[_nghost-%COMP%]     .blog-content pre{background:#111;padding:12px;border-radius:6px;overflow-x:auto;white-space:pre;margin:.75rem 0}[_nghost-%COMP%]     .blog-content pre code{display:block;min-width:100%}"]})};export{I as BlogComponent};
